{% extends 'homepage.html' %}
{% block content %}
<h2>2. FAMILY BACKGROUND</h2>

<form method="POST" enctype="multipart/form-data" id="familyBackgroundForm">
    {% csrf_token %}

    <!-- Parental Status -->
    <label>Parental Status (Tick as appropriate)</label>
    {{ form.parental_status }}

    <div id="death_certificate_field" style="display: none;">
        <label>Attach Death Certificate (if deceased):</label>
        {{ form.death_certificate }}
    </div>

    <!-- Father Details -->
    <div id="father_fields">
        <h3>Father</h3>
        <label>Age:</label> {{ form.father_age }}
        <label>Occupation:</label> {{ form.father_occupation }}
        <label>Current Employer:</label> {{ form.father_employer }}
        <label>Health Status (Attach evidence):</label> {{ form.father_health_status }}
    </div>

    <!-- Mother Details -->
    <div id="mother_fields">
        <h3>Mother</h3>
        <label>Age:</label> {{ form.mother_age }}
        <label>Occupation:</label> {{ form.mother_occupation }}
        <label>Current Employer:</label> {{ form.mother_employer }}
        <label>Health Status (Attach evidence):</label> {{ form.mother_health_status }}
    </div>

    <!-- Sibling Details -->
    <h3>Siblings (Brothers and Sisters)</h3>
    <label>Total number of siblings (Excluding yourself):</label> {{ form.total_siblings }}
    <label>Number in University/College:</label> {{ form.university_siblings }}
    <label>Number in Secondary:</label> {{ form.secondary_siblings }}
    <label>How many are out of school? Why?</label>
    {{ form.out_of_school_siblings }} {{ form.out_of_school_reason }}
    <label>Any who are working and their occupations:</label> {{ form.working_siblings_occupation }}
    <a href="{% url 'application' %}" class="btn">BACK</a>
    <button type="button" id="backBtn">Back</button>
    <button type="submit" onclick="window.location.href='{% url 'application' %}'">Next</button>
</form>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const parentalStatus = document.querySelectorAll("input[name='parental_status']");
    const deathCertificateField = document.getElementById("death_certificate_field");
    const fatherFields = document.getElementById("father_fields");
    const motherFields = document.getElementById("mother_fields");

    function toggleFields() {
        let selectedValue = document.querySelector("input[name='parental_status']:checked").value;
        if (selectedValue === "orphan") {
            deathCertificateField.style.display = "block";
            fatherFields.style.display = "none";
            motherFields.style.display = "none";
        } else if (selectedValue === "one") {
            deathCertificateField.style.display = "block";
            fatherFields.style.display = "block";
            motherFields.style.display = "block";
        } else {
            deathCertificateField.style.display = "none";
            fatherFields.style.display = "block";
            motherFields.style.display = "block";
        }
    }

    parentalStatus.forEach(input => {
        input.addEventListener("change", toggleFields);
    });

    toggleFields();
});
</script>
{% endblock %}
